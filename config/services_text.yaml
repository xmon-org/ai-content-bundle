# Text providers and services
# This file is loaded when text providers are configured

services:
    _defaults:
        autowire: true
        autoconfigure: true

    # Text Provider (Pollinations only - simplified architecture Dec 2025)
    # All text generation uses Pollinations API with model selection via TaskConfigService
    Xmon\AiContentBundle\Provider\Text\PollinationsTextProvider:
        arguments:
            $model: 'openai'
            $fallbackModels: []
            $timeout: 60
            $priority: 10
        tags:
            - { name: 'xmon_ai_content.text_provider', priority: 10 }
            - { name: 'monolog.logger', channel: 'ai' }

    # Main Text Service
    Xmon\AiContentBundle\Service\AiTextService:
        arguments:
            $providers: !tagged_iterator { tag: 'xmon_ai_content.text_provider', default_priority_method: 'getPriority' }
            $taskConfigService: '@Xmon\AiContentBundle\Service\TaskConfigService'
            $retries: 2
            $retryDelay: 3
        tags:
            - { name: 'monolog.logger', channel: 'ai' }
